<html>

<head>
    <title>Mission 1</title>
    <meta charset="utf-8"/>
</head>

<body>
<ul id="todo-list"></ul>
<script>
    const data = [
        {
            text: 'JS 공부하기'
        },
        {
            text: 'JS 복습하기'
        }
    ]

    const nextData = [
        ...data,
        {
            text: 'js 추가하기'
        },
        {
            text: 'js 추가하기2'
        }
    ];

    const a = 1

    // 이곳에서 코딩을 시작하세요!
    function TodoList(todo) {
        if (!new.target) {
            throw new Error('new keyword error');
        }

        this.todo = todo;

        this.isValidation = function () {
            if (this.todo === null || this.todo === undefined) {
                return {
                    error: true,
                    message: '데이터 값이 null 또는 undefined입니다.'
                }
            }

            if (!Array.isArray(this.todo)) {
                return {
                    error: true,
                    message: '배열이 아닙니다.'
                }
            }

            if (typeof this.todo !== "object" || !this.todo.every((e) => e.hasOwnProperty('text'))) {
                return {
                    error: true,
                    message: '데이터 형식이 올바르지 않습니다.'
                }
            }

            return {
                error: false
            }
        }

        const validation = this.isValidation();

        if (validation.error) {
            throw new Error(this.isValidation().message);
        }

        this.render = function () {
            if (this.isValidation().error) {
                throw new Error(this.isValidation().message);
            }

            const result = this.todo.map((el) => `<li>${el.text}</li>`).join('');
            document.querySelector('#todo-list').innerHTML = result;
        }

        this.setState = function (nextData) {
            this.todo = nextData;
            // console.log('>>>', nextData);
            this.render();
        }
    }

    const todolist = new TodoList(null);
    todolist.setState(nextData);
</script>
</body>
</html>
